<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="../style.css">
    <link rel="shortcut icon" href="../favicon.png" type="image/x-icon">
    <script src="../bundle.js" type="module"></script>
    <title>AEW - SVG</title>

    <script>
        // Acceso al DOM de una imagen SVG vinculada a un documento HTML 
        // Es importante tener en cuenta las indicaciones relativas a la carga de la página
        function main() {

            var oMapa = {
                oElementoSVG: {},
                aRegiones_path: [],
                aRegiones_poli: [],
                aRegiones: [],
                oNodoNombre: {},
                oNodoBandera: {},
                inRegion: function (oEvent) {
                    var region = oEvent.target.getAttribute("id");
                    this.oNodoNombre.innerHTML = region;
                    this.oNodoBandera.querySelector("img").src="../Banderas/" + region + ".gif";
                },
                outMapa: function () {
                    this.oNodoNombre.innerHTML = ""
                    this.oNodoBandera.querySelector("img").src = "";
                },
                paginaCargada: function () {
                    this.aRegiones = this.aRegiones_path.concat(this.aRegiones_poli);
                    this.oElementoSVG = document.querySelector('embed').getSVGDocument().documentElement;
                    // en este caso no  valtdría 
                    // this.oElementoSVG = document.querySelector('embed').contentDocument;

                    //this.oElementoSVG.setAttribute("height", "658.04449px");
                    //this.oElementoSVG.setAttribute("width", "923.32129px");
                    //this.oElementoSVG.setAttribute("viewBox", "200 0 658.04449 923.32129");

                    this.oNodoNombre = document.getElementById("info_2");
                    this.oNodoBandera = document.getElementById("bandera");
                    this.aRegiones_path = this.oElementoSVG.querySelectorAll('path');
                    this.aRegiones_poli = this.oElementoSVG.querySelectorAll('polygon');
                    //this.aRegiones = this.aRegiones_path.concat(this.aRegiones_poli);
                    // array de Nodos con todas los elementos: uno por cada region
                    // no valido para arrais de nodos
                    for (var i = 0; i < this.aRegiones_path.length; i++) {
                        this.aRegiones_path[i].onmouseover = this.inRegion.bind(this)
                    } // recorremos el array de nodos correspondientes a cada region
                    for (var i = 0; i < this.aRegiones_poli.length; i++) {
                        this.aRegiones_poli[i].onmouseover = this.inRegion.bind(this)
                    } // recorremos el array de nodos correspondientes a cada region
                    this.oElementoSVG.onmouseout = this.outMapa.bind(this)
                } //Fin del método paginaCargada
            }; //Fin del objeto oSVG

            oMapa.paginaCargada()
        }

        window.addEventListener("load",main,false);
        //Es necesario esperar al evento window.onload 
        //No funciona si se espera a la carga del documento

    </script>
</head>

<body>
    <header>
        <h1> API EveryWhere </h1>
    </header>
    <!--  Menu principal -->
    <nav class="menuPC">
        <ul>
            <li>
                <a href="../index.html">Home</a>
            </li>
            <li>
                <a href="./canva.html">Canvas</a>
            </li>
            <li>
                <a href="./geolocation.html">Geolocation</a>
            </li>
            <li>
                <a href="./video.html">Video</a>
            </li>
            <li>
                <a href="./svg.html">SVG + DragAndDrop</a>
            </li>
            <li>
                <a href="./about.html">About</a>
            </li>
        </ul>
    </nav>
    <nav class="menuMob">
        <span id="menuBtn" class="mobile_ham">
            <img src="../assets/hamburger.png">
        </span>
        <ul>
            <li>
                <a href="../index.html">Home</a>
            </li>
            <li>
                <a href="./canva.html">Canvas</a>
            </li>
            <li>
                <a href="./geolocation.html">Geolocation</a>
            </li>
            <li>
                <a href="./video.html">Video</a>
            </li>
            <li>
                <a href="./svg.html">SVG + DragAndDrop</a>
            </li>
            <li>
                <a href="./about.html">About</a>
            </li>
        </ul>
    </nav>

    <!-- Contenido principal -->
    <main>
        <article>
            <div id="mapa_2" class="mapa">
                <embed id="imagen" type="image/svg+xml" src="../assets/españa.svg"></embed>
            </div>
            <p id="info_2" class="info"></p>            
        </article>
        <div id="bandera"><img src="" alt="" /></div>
    </main>
    <footer>
        <address>
            <p>&copy; Carlos López y David Rodríguez. BabelCamp 2018. Madrid</p>
        </address>
    </footer>
</body>

</html>